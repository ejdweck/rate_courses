{% extends 'index.html' %}
{% block content %}
<div class="container">
	<h2 class="homepage-text">The Real Course Guide</h2>
</div>
<br>
<div class="container">
	<div class="row">
	  <div class="container">
	  	<form method="get" action="/search/" role="search">
		    <div class="input-group">
		      <input type="text" class="form-control" placeholder="Search for a Course" name="searchbox">
		      <span class="input-group-btn">
		        <button value="Search" type="text" id="search-submit" class="btn btn-secondary">Search</a>
		      </span>
		    </div>
	        <small id="help" class="form-text text-muted">Confused about ratings or card colors? Check out the <a href="{% url 'about' %}">about page</a> </small>
		</form>
	  </div>
	</div>
</div>
<br>
<div class="container"> 
	<h2>Recent Course Reviews</h2>
	<div class="card-deck">
	{% for course in course_reviews %}
	    <div class="card border-dark mb-3 color{{course.rating}}" id="card_box">
	    	<a href="/course/{{course.courseId.courseId}}" class="card-header">
		    	    <h6 >{{course.courseId.courseDepartment}}{{course.courseId.courseNumber}}</h6>
					<h6 class="card-subtitle text-muted">{{course.courseId.courseName}}</h6>
	    	</a>
		    <div class="card-body text-dark" data-toggle="modal" data-target=".review-{{course.reviewId}}">
				<div class="modal fade course-review-modal review-{{course.reviewId}}" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
				  <div class="modal-dialog modal-lg ">
				    <div class="modal-content">
				    	<div class="modal-header">
					    	<h5 class="modal-title" id="course-code-modal">{{course.courseId.courseDepartment}}{{course.courseId.courseNumber}}</h5>
					    </div>
	  			        <div class="modal-body">
					    	<h5 href="/course/{{course.courseId.courseId}}" class="modal-title text-muted" id="course-title-modal">{{course.courseId.courseName}}</h5>
					    	<div class="row">
					    		<div class="col-md-6">
							    	<div class="card review-card">
								        <p class="review-title">Review</p>
								        <p class="review-text">{{course.review}}</p>
							        </div>
						    	</div>
						    	<div class="col-md-6">
									<canvas id="pie-chart" width="20" height="10"></canvas>
									<script>
									new Chart(document.getElementById("pie-chart"), {
									    type: 'pie',
									    data: {
									      labels: ["Africa", "Asia", "Europe", "Latin America", "North America"],
									      datasets: [{
									        label: "Population (millions)",
									        backgroundColor: ["#3e95cd", "#8e5ea2","#3cba9f","#e8c3b9","#c45850"],
									        data: [2478,5267,734,784,433]
									      }]
									    },
									    options: {
									      title: {
									        display: true,
									        text: 'Predicted world population (millions) in 2050'
									      }
									    }
									});	
									</script>
						    	</div>
					    	</div>
	  			        	<div class="course-tags-modal">
						        {% if course.courseReviewTagId.weedOutCourse == 1 %}
						        	<button class="btn btn-outline-danger btn-sm " id="course-tag">Weed Out</button>
						        {% endif %}
								{% if course.courseReviewTagId.interestingContent == 1 %}
						        	<button class="btn btn-outline-primary btn-sm " id="course-tag">Interesting Content</button>
						        {% endif %}
						        {% if course.courseReviewTagId.lotsOfHomework == 1 %}
						        	<button class="btn btn-outline-warning btn-sm " id="course-tag">Lots of Homework</button>
						        {% endif %}
								{% if course.courseReviewTagId.mandatoryAttendance == 1 %}
						        	<button class="btn btn-outline-info btn-sm " id="course-tag"> Mandatory Attendance </button>
						        {% endif %}
					    	</div>
					    </div>
					    <div class="modal-footer">
						    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
					    </div>
				    </div>
				  </div>
				</div>
		        <p class="card-text">Instructor: {{course.instructorId.firstName}} {{course.instructorId.lastName}}</p>
		        <div class="card review-card">
			        <p class="review-title">Review</p>
			        <p class="review-text">{{course.review}}</p>
		        </div>
    				
		    	<div class="progress">
					<div class="progress-bar" role="progressbar" style="width: {{course.rating_percentage}}%;" aria-valuenow="" aria-valuemin="0" aria-valuemax="10">
					</div>
					<span>{{course.rating}}/10</span>
			    </div>
			    <div class="course-tags-card">
			        {% if course.courseReviewTagId.weedOutCourse == 1 %}
				        <span class="badge badge-pill badge-danger"> </span>
			        {% endif %}
					{% if course.courseReviewTagId.interestingContent == 1 %}
				        <span class="badge badge-pill badge-primary"> </span>
			        {% endif %}
			        {% if course.courseReviewTagId.lotsOfHomework == 1 %}
				        <span class="badge badge-pill badge-warning"> </span>
			        {% endif %}
					{% if course.courseReviewTagId.mandatoryAttendance == 1 %}
				        <span class="badge badge-pill badge-info"> </span>
			        {% endif %}
		    	</div>
		    </div>
		    <div class="card-footer">
		      <small class="text-dark">Reviewed on {{course.reviewDate}}</small>
		    </div>
		</div>
	{% endfor %}
	</div>
	{% if course_reviews.has_other_pages %}
	  <ul class="pagination justify-content-center">
	    {% if course_reviews.has_previous %}
			<li class="page-item">
		      <a class="page-link" href="?page={{ course_reviews.previous_page_number }}" tabindex="-1">Previous</a>
		    </li>
	    {% else %}
	      	<li class="disabled"></li>
	    {% endif %}
	    {% for i in course_reviews.paginator.page_range %}
	      {% if course_reviews.number == i %}
	        <li class="active">
	        	<a class="page-link">{{ i }}<span class="sr-only">(current)</span></a>
	        </li>
	      {% elif i > course_reviews.number|add:'-3' and i < course_reviews.number|add:'3' %}
		    <li class="page-item"><a class="page-link" href="?page={{ i }}">{{ i }}</a></li>
	      {% endif %}
	    {% endfor %}
	    {% if course_reviews.has_next %}
	    <li class="page-item">
	    	<a class="page-link" href="?page={{ course_reviews.next_page_number }}">Next</a>
	    </li>
	    {% else %}
	      <li class="disabled"></li>
	    {% endif %}
	  </ul>
	{% endif %}
</div>
{% endblock %}
